{
  "Name": "data-protection-policy",
  "Description": "Policy to mask sensitive data in logs",
  "Version": "2021-06-01",
  "Statement": [
    {
      "Sid": "audit-policy",
      "DataIdentifier": [
        "arn:aws:dataprotection::aws:data-identifier/EmailAddress",
        "arn:aws:dataprotection::aws:data-identifier/PhoneNumber-US",
        "arn:aws:dataprotection::aws:data-identifier/Name",
        "arn:aws:dataprotection::aws:data-identifier/Ssn-US",
        "arn:aws:dataprotection::aws:data-identifier/BankAccountNumber-US",
        "arn:aws:dataprotection::aws:data-identifier/CreditCardNumber",
        "AgentId"
      ],
      "Operation": {
        "Audit": {
          "FindingsDestination": {}
        }
      }
    },
    {
      "Sid": "redact-policy",
      "DataIdentifier": [
        "arn:aws:dataprotection::aws:data-identifier/EmailAddress",
        "arn:aws:dataprotection::aws:data-identifier/PhoneNumber-US",
        "arn:aws:dataprotection::aws:data-identifier/Name",
        "arn:aws:dataprotection::aws:data-identifier/Ssn-US",
        "arn:aws:dataprotection::aws:data-identifier/BankAccountNumber-US",
        "arn:aws:dataprotection::aws:data-identifier/CreditCardNumber",
        "AgentId"
      ],
      "Operation": {
        "Deidentify": {
          "MaskConfig": {}
        }
      }
    }
  ],
  "Configuration": {
    "CustomDataIdentifier": [
      {
        "Name": "AgentId",
        "Regex": "[A-Z]{5}[0-9]{5}"
      }
    ]
  }
}